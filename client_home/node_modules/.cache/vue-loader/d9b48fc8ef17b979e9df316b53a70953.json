{"remainingRequest":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\views\\book_mall\\details.vue?vue&type=style&index=0&id=399915b3&lang=css&","dependencies":[{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\views\\book_mall\\details.vue","mtime":1657768166000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5xZWNvZGUgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24tY29udGVudDogY2VudGVyOwogIHdpZHRoOiAyNzBweDsKICBiYWNrZ3JvdW5kOiB3aGl0ZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMjAlOwogIHRvcDogMjBweDsKICB6LWluZGV4OiA5OTk7Cn0KLnFlY29kZUltZyB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGFsaWduLWNvbnRlbnQ6IGNlbnRlcjsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgcGFkZGluZy10b3A6IDEwcHg7CiAgbWFyZ2luOiAwIGF1dG87Cn0KLmJ0bl9zaGFyZXsKCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCXBvc2l0aW9uOiByZWxhdGl2ZTsKCXRvcDogMTVweDsKCWJhY2tncm91bmQ6IHJnYigyNDAsIDIzOCwgMjM4KTsKCWJvcmRlcjogMXB4IHNvbGlkICNjY2M7CgloZWlnaHQ6IDM4cHg7CgltYXJnaW4tbGVmdDogMTBweDsKCXBhZGRpbmc6IDNweCAxMHB4OwoJY3Vyc29yOiBwb2ludGVyOwoJb3ZlcmZsb3c6IGhpZGRlbjsKCWJvcmRlci1yYWRpdXM6IDVweDsKfQouYnRuX3NoYXJlX2ljb257Cgl3aWR0aDogMzBweDsKCWhlaWdodDogMjhweDsKCWZsb2F0OiBsZWZ0OwoJbWFyZ2luLXJpZ2h0OiAxMHB4Owp9Ci5zaGFyZV9ib3h7CglkaXNwbGF5OiBub25lOwoJZmxvYXQ6IGxlZnQ7Cn0KLnNoYXJlX2JveCBpbWd7Cgl3aWR0aDogMzBweDsKCWhlaWdodDogMjhweDsKCW1hcmdpbi1yaWdodDogMTBweDsKfQouYnRuX3NoYXJlOmhvdmVyIC5zaGFyZV9ib3h7CglkaXNwbGF5OiBibG9jazsKfQo="},{"version":3,"sources":["details.vue"],"names":[],"mappings":";AA2SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"details.vue","sourceRoot":"src/views/book_mall","sourcesContent":["<template>\n\t<div class=\"diy_details page_book_mall\" id=\"book_mall_details\">\n\t\t<div class='warp'>\n\t\t\t<div class='container'>\n\t\t\t\t<div class='row'>\n\t\t\t\t\t<div class='col'>\n\t\t\t\t\t\t<div class='card_book_mall'>\n\t\t\t\t\t\t\t<div_book_mall :obj=\"obj\"></div_book_mall>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- 评论区 -->\n\t\t<div class=\"warp\" v-if=\"$check_action('/comment/list', 'get')\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<!-- 评论区 -->\n\t\t\t\t\t<div class=\"col\">\n\t\t\t\t\t\t<bar_title class=\"mt\" title=\"评论区\"\tv-if=\"list_comment.length\"/>\n\t\t\t\t\t\t<div class=\"comment_box\"\tv-if=\"list_comment.length\">\n\t\t\t\t\t\t\t<list_comment\n\t\t\t\t\t\t\t\t\tclass=\"w-100\"\n\t\t\t\t\t\t\t\t\t:list=\"list_comment\"\n\t\t\t\t\t\t\t\t\t:obj=\"form_comment\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<b-pagination-nav\n\t\t\t\t\t\t\t\t\t:base-url=\"$route.path\"\n\t\t\t\t\t\t\t\t\t:number-of-pages=\"count_pages\"\n\t\t\t\t\t\t\t\t\t:link-gen=\"link_gen\"\n\t\t\t\t\t\t\t\t\t@change=\"change_page\"\n\t\t\t\t\t\t\t\t\tfirst-number\n\t\t\t\t\t\t\t\t\tlast-number\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<!-- 发表评论 -->\n\t\t\t\t\t\t<div class=\"form_editor form_edit_box\">\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class=\"details_form_editor_title\">发表评论</div>\n\t\t\t\t\t\t\t<div class=\"fl ml-3 answer_title\" v-show=\"form_comment.reply_to_id\">\n\t\t\t\t\t\t\t\t对 <i>{{ respondent }}</i> 回复:\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"fr mr-3\" v-show=\"form_comment.reply_to_id\">\n\t\t\t\t\t\t\t\t<b-button\n\t\t\t\t\t\t\t\t\t\tvariant=\"outline-primary reset_answer_personnel\"\n\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t@click=\"form_comment.reply_to_id = 0\"\n\t\t\t\t\t\t\t\t>重置回复人\n\t\t\t\t\t\t\t\t</b-button\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<form_editor\n\t\t\t\t\t\t\t\t\tclass=\"fn\"\n\t\t\t\t\t\t\t\t\t:form=\"form_comment\"\n\t\t\t\t\t\t\t\t\t@update_comment=\"update_comment\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport div_book_mall from \"@/components/diy/div_book_mall.vue\";\n\timport list_comment from \"@/components/diy/list_comment.vue\";\n\timport bar_title from \"@/components/diy/bar_title.vue\";\n\timport form_editor from \"@/components/diy/form_editor.vue\";\n\timport mixin from \"@/mixins/page.js\";\n\texport default {\n\t\tmixins:[mixin],\n\t\tcomponents:{\n\t\t\tlist_comment,\n\t\t\tbar_title,\n\t\t\tform_editor,\n\t\t\tdiv_book_mall\n\t\t},\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\turl_get_obj: \"~/api/book_mall/get_obj?\",\n\n\t\t\t\tfield: \"book_mall_id\",\n\n\t\t\t\tobj: {\n\t\t\t\t},\n\n\t\t\t\tquery: {\n\t\t\t\t\t\"author\": \"\",\n\t\t\t\t\t\"press\": \"\",\n\t\t\t\t\t\"discount_intensity\": \"\",\n\t\t\t\t\t\"book_mall_id\":0,\n\t\t\t\t},\n\t\t\t\t// 点赞\n\t\t\t\tpraise: 0,\n\t\t\t\t// 点赞状态\n\t\t\t\tstate_praise: false,\n\t\t\t\t// 收藏状态\n\t\t\t\tstate_collect: false,\n\t\t\t\tlist_comment: [],\n\t\t\t\tform_comment: {\n\t\t\t\t\tsource_table: \"book_mall\",\n\t\t\t\t\tsource_field: \"book_mall_id\",\n\t\t\t\t\tsource_id: 0,\n\t\t\t\t\treply_to_id: 0,\n\t\t\t\t},\n\t\t\t\tcount_pages: 1, // 页面数\n\t\t\t\t\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tget_obj_after(json) {\n\t\t\t\t// 判断是否获取到数据\n\t\t\t\tif (json && json.result && json.result.obj) {\n\t\t\t\t\tconsole.log(json.result.obj)\n\t\t\t\t\tvar obj = json.result.obj;\n\t\t\t\t\tthis.obj = obj\n\t\t\t\t\t// 增加点击数\n\t\t\t\t\t// 初始化收藏状态\n\t\t\t\t\tthis.get_collect(obj);\n\t\t\t\t\tthis.get_comment(obj);\n\t\t\t\t\tthis.form_comment.source_id = this.obj.book_mall_id;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 初始化收藏状态\n\t\t\t * @param {Object} obj\n\t\t\t */\n\t\t\tget_collect(obj) {\n\t\t\t\tvar user_id = this.user.user_id;\n\n\t\t\t\tvar query = {\n\t\t\t\t\tsource_table: \"book_mall\",\n\t\t\t\t\tsource_field: \"book_mall_id\",\n\t\t\t\t\tsource_id: obj[\"book_mall_id\"],\n\t\t\t\t\tuser_id\n\t\t\t\t};\n\n\t\t\t\tthis.$get('~/api/collect/count?', query, (res) => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tif (res.result || res.result === 0) {\n\t\t\t\t\t\tvar bl = res.result ? true : false;\n\t\t\t\t\t\tthis.state_collect = bl;\n\t\t\t\t\t\tconsole.log(\"收藏状态：\" + bl);\n\t\t\t\t\t}\n\t\t\t\t\telse if(res.error) {\n\t\t\t\t\t\tconsole.error(res.error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t /****\n\t\t\t * 分享点击\n\t\t\t * \n\t\t\t *  */ \n\t\t\ttoShare(e){\n\t\t\t\twindow.open(e);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 改变收藏状态\n\t\t\t */\n\t\t\tchange_collect() {\n\t\t\t\tvar user_id = this.user.user_id;\n\n\t\t\t\tvar query = {\n\t\t\t\t\tsource_table: \"book_mall\",\n\t\t\t\t\tsource_field: \"book_mall_id\",\n\t\t\t\t\tsource_id: this.obj[\"book_mall_id\"],\n\t\t\t\t\tuser_id\n\t\t\t\t};\n\n\t\t\t\t// 收藏状态\n\t\t\t\tif (this.state_collect) {\n\t\t\t\t\tthis.state_collect = false;\n\t\t\t\t\tthis.$get('~/api/collect/del?', query, (res) => {\n\t\t\t\t\t\tif(res.result){\n\t\t\t\t\t\t\tthis.$toast(\"取消收藏\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (res.error){\n\t\t\t\t\t\t\tthis.$toast(res.error.message);\n\t\t\t\t\t\t\tconsole.error(res.error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.state_collect = true;\n\t\t\t\t\tthis.$post('~/api/collect/add?', query, (res) => {\n\t\t\t\t\t\tif (res.result) {\n\t\t\t\t\t\t\tthis.$toast(\"收藏成功\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (res.error) {\n\t\t\t\t\t\t\tthis.$toast(res.error.message);\n\t\t\t\t\t\t\tconsole.error(res.error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t},\n\t\t\t/**\n\t\t\t * 分页器\n\t\t\t * @param { Number } page_num 分页数\n\t\t\t * @return { Object } 查询对象\n\t\t\t */\n\t\t\tlink_gen(page_num) {\n\t\t\t\treturn {\n\t\t\t\t\tquery: this.query,\n\t\t\t\t};\n\t\t\t},\n\t\t\t/**\n\t\t\t *加载下一页\n\t\t\t */\n\t\t\tchange_page(page_num) {\n\t\t\t\tthis.get_comment(this.obj, page_num);\n\t\t\t\tthis.form_comment.reply_to_id = 0;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 更新评论\n\t\t\t */\n\t\t\tupdate_comment() {\n\t\t\t\tthis.get_comment(this.obj);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取评论\n\t\t\t * @param { Object } obj 文章对象\n\t\t\t * @param { Number } page 分页数\n\t\t\t * @param { Number } size 评论显示条数\n\t\t\t */\n\t\t\tget_comment(obj, page = 1, size = 5) {\n\t\t\t\tthis.$get(\n\t\t\t\t\t\t\"~/api/comment/get_list?\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsource_table: \"book_mall\",\n\t\t\t\t\t\t\tsource_field: \"book_mall_id\",\n\t\t\t\t\t\t\tsource_id: this.obj[\"book_mall_id\"],\n\t\t\t\t\t\t\tpage,\n\t\t\t\t\t\t\tsize,\n\t\t\t\t\t\t\treply_to_id: \"0\",\n\t\t\t\t\t\t\torderby: \"create_time desc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(json) => {\n\t\t\t\t\t\t\tif (json.result) {\n\t\t\t\t\t\t\t\tvar list_comment = json.result.list;\n\t\t\t\t\t\t\t\tlist_comment.map((o) => {\n\t\t\t\t\t\t\t\t\to.list_reply = [];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.add_reply(list_comment).then((list) => {\n\t\t\t\t\t\t\t\t\tthis.list_comment = list;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.count_pages = Math.ceil(json.result.count / size) || 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\t/**\n\t\t\t * @param { Array } list 评论列表\n\t\t\t * 添加回复到评论列表\n\t\t\t */\n\t\t\tadd_reply(list) {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tfor (let idx = 0; idx < list.length; idx++) {\n\t\t\t\t\t\tconst obj = list[idx];\n\t\t\t\t\t\tthis.$get(\n\t\t\t\t\t\t\t\t\"~/api/comment/get_list?\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsource_table: \"book_mall\",\n\t\t\t\t\t\t\t\t\tsource_field: \"book_mall_id\",\n\t\t\t\t\t\t\t\t\tsource_id: this.obj[\"book_mall_id\"],\n\t\t\t\t\t\t\t\t\torderby: \"create_time desc\",\n\t\t\t\t\t\t\t\t\treply_to_id: obj.comment_id,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t(res) => {\n\t\t\t\t\t\t\t\t\tif (res.result) {\n\t\t\t\t\t\t\t\t\t\tobj.list_reply = res.result.list;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(list);\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tcomputed: {\n\t\t\trespondent() {\n\t\t\t\tvar reply_to_id = this.form_comment.reply_to_id;\n\t\t\t\tvar respondent = \"\";\n\t\t\t\tthis.list_comment.map((o) => {\n\t\t\t\t\tif (o.comment_id === reply_to_id) {\n\t\t\t\t\t\trespondent = o.nickname;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn respondent;\n\t\t\t},\n\t\t},\n\t\t\n\t\tmounted() {\n\t\t\t\n\t\t},\n\t\t\n\t}\n</script>\n\n<style>\n.qecode {\n  display: flex;\n  align-content: center;\n  width: 270px;\n  background: white;\n  position: absolute;\n  left: 20%;\n  top: 20px;\n  z-index: 999;\n}\n.qecodeImg {\n  display: flex;\n  flex-direction: column;\n  align-content: center;\n  text-align: center;\n  padding-top: 10px;\n  margin: 0 auto;\n}\n.btn_share{\n\tdisplay: inline-block;\n\tposition: relative;\n\ttop: 15px;\n\tbackground: rgb(240, 238, 238);\n\tborder: 1px solid #ccc;\n\theight: 38px;\n\tmargin-left: 10px;\n\tpadding: 3px 10px;\n\tcursor: pointer;\n\toverflow: hidden;\n\tborder-radius: 5px;\n}\n.btn_share_icon{\n\twidth: 30px;\n\theight: 28px;\n\tfloat: left;\n\tmargin-right: 10px;\n}\n.share_box{\n\tdisplay: none;\n\tfloat: left;\n}\n.share_box img{\n\twidth: 30px;\n\theight: 28px;\n\tmargin-right: 10px;\n}\n.btn_share:hover .share_box{\n\tdisplay: block;\n}\n</style>\n"]}]}