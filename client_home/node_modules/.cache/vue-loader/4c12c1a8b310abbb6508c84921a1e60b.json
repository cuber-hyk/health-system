{"remainingRequest":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\src\\views\\exam\\details.vue?vue&type=style&index=0&id=2cc28c6c&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\src\\views\\exam\\details.vue","mtime":1675233590000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50aXRsZV9tYXJnaW57CiAgICB3aWR0aDogMTAwMHB4OwogICAgbWFyZ2luLXRvcDogMjBweDsKfQouYW5zd2VyX3N1Ym1pdF9idXR0b257CiAgICBtYXJnaW4tdG9wOiAzMHB4OwogICAgcGFkZGluZy1sZWZ0OiA3MHB4OwogICAgbWFyZ2luLWJvdHRvbTogMzBweDsKfQouYW5zd2VyX3N1Ym1pdF9idXR0b24gYnV0dG9uewogICAgd2lkdGg6IDEwMHB4OwogICAgbGluZS1oZWlnaHQ6IDQwcHg7CiAgICBib3JkZXItcmFkaXVzOiA1cHg7Cn0KLmFuc3dlcl9idG5fc3VibWl0ewogICAgYmFja2dyb3VuZC1jb2xvcjogYmx1ZTsKICAgIG1hcmdpbi1yaWdodDogMjBweDsKICAgIGNvbG9yOiB3aGl0ZTsKfQouYW5zd2VyX2J0bl9jYW5jZWx7Cn0KLmNvdW50ZG93bnsKICAgIHdpZHRoOiAxMDAwcHg7CiAgICBtYXJnaW4tdG9wOiAyMHB4Owp9Ci5jb3VudGRvd24gc3BhbnsKICAgIGNvbG9yOiByZWQ7Cn0KLnNjb3JlX3Nob3d7CiAgICBjb2xvcjogcmVkOwp9Cg=="},{"version":3,"sources":["details.vue"],"names":[],"mappings":";AAqTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"details.vue","sourceRoot":"src/views/exam","sourcesContent":["<template>\r\n    <div class=\"page_exam\" id=\"exam_view\">\r\n        <div class=\"warp\" v-if=\"$check_exam('/exam/list', 'answers')\">\r\n            <div class=\"container exam-detail\">\r\n                <div class=\"row\">\r\n                    <div v-if=\"!if_answered\" class=\"countdown\">\r\n                        距离考试结束还有：<span>{{minutes+\":\"+seconds}}</span>\r\n                    </div>\r\n                    <div class=\"col-24 col-lg-24 col-md-24\">\r\n                        <div v-if=\"if_answered\" class=\"col-24 col-lg-24 col-md-24\">\r\n                            <div class=\"title_margin\" style=\"margin-bottom: 20px\" v-if=\"score_state===0\">未评分</div>\r\n                            <div class=\"title_margin\" style=\"margin-bottom: 20px\" v-else>已评分，得分：<span style=\"color: red\">{{answer_form.score}}</span></div>\r\n                        </div>\r\n                    </div>\r\n                    <div v-for=\"(o,i) in question_list\" :key=\"o\">\r\n                        <div class=\"title_margin\" v-if=\"o.type === '单选题'\">\r\n                            {{o.question_order+'.单选题：'+o.title+\"   (\"+o.score+\"分)\"}}\r\n                            <span v-if=\"if_answered\" class=\"score_show\">--------{{answer_scores[i]}}分</span>\r\n                        </div>\r\n                        <div class=\"title_margin\" v-else-if=\"o.type === '多选题'\">\r\n                            {{o.question_order+'.多选题：'+o.title+\"   (\"+o.score+\"分)\"}}\r\n                            <span v-if=\"if_answered\" class=\"score_show\">--------{{answer_scores[i]}}分</span>\r\n                        </div>\r\n                        <div class=\"title_margin\" v-else-if=\"o.type === '判断题'\">\r\n                            {{o.question_order+'.判断题：'+o.title+\"   (\"+o.score+\"分)\"}}\r\n                            <span v-if=\"if_answered\" class=\"score_show\">--------{{answer_scores[i]}}分</span>\r\n                        </div>\r\n                        <div class=\"title_margin\" v-else-if=\"o.type === '填空题'\">\r\n                            {{o.question_order+'.填空题：'+o.title+\"   (\"+o.score+\"分)\"}}\r\n                            <span v-if=\"if_answered\" class=\"score_show\">\r\n                                <span v-if=\"score_state===0\">--------未评分</span>\r\n                                <span v-else>--------{{answer_scores[i]}}分</span>\r\n\t\t\t\t\t\t    </span>\r\n                        </div>\r\n                        <div class=\"title_margin\" v-else>\r\n                            {{o.question_order+'.主观题：'+o.title+\"   (\"+o.score+\"分)\"}}\r\n                            <span v-if=\"if_answered\" class=\"score_show\">\r\n\t\t\t\t\t\t\t<span v-if=\"score_state===0\">--------未评分</span>\r\n\t\t\t\t\t\t\t<span v-else>--------{{answer_scores[i]}}分</span>\r\n\t\t\t\t\t\t</span>\r\n                        </div>\r\n                        <div v-if=\"o.type === '单选题'\">\r\n                            <label style=\"margin-right: 20px;\" v-for=\"q in get_question_list(o.question_item)\">\r\n                                <input :disabled=\"if_answered\" :name=\"o.title\" type=\"radio\" :value=\"q\" v-model=\"answers[i]\"/>{{q}}\r\n                            </label>\r\n                            <div class=\"score_show\" v-if=\"if_answered && reference_answers[i]\">\r\n                                参考答案：{{reference_answers[i]}}\r\n                            </div>\r\n                        </div>\r\n                        <div v-else-if=\"o.type === '多选题'\">\r\n                            <label style=\"margin-right: 20px;\" v-for=\"q in get_question_list(o.question_item)\">\r\n                                <input :disabled=\"if_answered\" :name=\"o.title\" type=\"checkbox\" :value=\"q\" v-model=\"answers[i]\"/>{{q}}\r\n                            </label>\r\n                            <div class=\"score_show\" v-if=\"if_answered && reference_answers[i]\">\r\n                                参考答案：{{reference_answers[i]}}\r\n                            </div>\r\n                        </div>\r\n                        <div v-else-if=\"o.type === '判断题'\">\r\n                            <label style=\"margin-right: 20px;\" v-for=\"q in get_question_list(o.question_item)\">\r\n                                <input :disabled=\"if_answered\" :name=\"o.title\" type=\"radio\" :value=\"q\" v-model=\"answers[i]\"/>{{q}}\r\n                            </label>\r\n                            <div class=\"score_show\" v-if=\"if_answered && reference_answers[i]\">\r\n                                参考答案：{{reference_answers[i]}}\r\n                            </div>\r\n                        </div>\r\n                        <div v-else-if=\"o.type === '填空题'\">\r\n                            <input :name=\"o.title\" :disabled=\"if_answered\" style=\"width: 500px\" v-model=\"answers[i]\" />\r\n                            <div class=\"score_show\" v-if=\"if_answered\">\r\n                                参考答案：{{reference_answers[i]}}\r\n                            </div>\r\n                        </div>\r\n                        <div v-else-if=\"o.type === '主观题'\">\r\n                            <textarea :name=\"o.title\" type=\"\" :disabled=\"if_answered\" style=\"width: 500px\" rows=\"3\" cols=\"20\" v-model=\"answers[i]\" ></textarea>\r\n                            <div class=\"score_show\" v-if=\"if_answered\">\r\n                                参考答案：{{reference_answers[i]}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"title_margin\">\r\n                        <div>\r\n                            <span>提交人：</span>\r\n                            <input :disabled=\"true\" style=\"width: 500px\" v-model=\"submit_user_str\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"row answer_submit_button\">\r\n                    <div class=\"col-12\">\r\n                        <div class=\"btn_box\">\r\n                            <button v-if=\"!if_answered\" class=\"answer_btn_submit\" @click=\"submit()\">提交</button>\r\n                            <button class=\"answer_btn_cancel\" @click=\"cancel()\">取消</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import mixin from \"@/mixins/page.js\";\r\n    export default {\r\n        mixins: [mixin],\r\n        components: {\r\n        },\r\n        data() {\r\n            return {\r\n                field: \"exam_id\",\r\n                url_add: \"~/api/user_answer/add?\",\r\n                url_set: \"~/api/user_answer/set?\",\r\n                url_get_obj: \"~/api/exam/get_obj?\",\r\n                url_upload: \"~/api/user_answer/upload?\",\r\n\r\n                query: {\r\n                    exam_id: 0,\r\n                },\r\n\r\n                form: {\r\n                    exam_id: 0,\r\n                    name: \"\",\r\n                    duration: 0,\r\n                    score: 0,\r\n                    status: \"启用\"\r\n                },\r\n                url_get_question_list: \"~/api/exam_question/get_list?\",\r\n                question_list:[],\r\n                answers:[],\r\n                submit_user_str:\"\",\r\n                answer_form:{\r\n                    user_answer_id:0,\r\n                    user_id:0,\r\n                    exam_id:0,\r\n                    score:0,\r\n                    score_state:0,\r\n                    answers:[],\r\n                    score_detail:[],\r\n                    objective_score:0,\r\n                    subjective_score:0,\r\n                    nickname:\"\"\r\n                },\r\n                if_answered:false,\r\n                maxtime:0,\r\n                minutes:0,\r\n                seconds:0,\r\n                timer:\"\",\r\n                score_state:0,\r\n                answer_scores:[],\r\n                reference_answers:[]\r\n            };\r\n        },\r\n        methods: {\r\n            async get_obj_after(){\r\n                let userJson = await this.$get(\"~/api/user/get_obj?user_id=\"+this.$store.state.user.user_id);\r\n                if(userJson.result){\r\n                    this.submit_user_str = userJson.result.obj.username+\"-\"+userJson.result.obj.nickname;\r\n                    this.answer_form.user_id = userJson.result.obj.user_id;\r\n                    this.answer_form.nickname = userJson.result.obj.nickname;\r\n                }else if(userJson.error){\r\n                    console.error(userJson.error);\r\n                }\r\n                let json = await this.$get(this.url_get_question_list+\"exam_id=\"+this.query.exam_id+\"&orderby=question_order\");\r\n                if(json.result){\r\n                    this.question_list = json.result.list;\r\n                    for (let i=0;i<this.question_list.length;i++){\r\n                        if (this.question_list[i].type==='多选题'){\r\n                            this.answers[i]=[];\r\n                        }else{\r\n                            this.answers[i]=\"\";\r\n                        }\r\n                    }\r\n                }else if(json.error){\r\n                    console.error(json.error);\r\n                }\r\n                let answerJson = await this.$get(\"~/api/user_answer/get_obj?user_id=\"+this.answer_form.user_id+\"&exam_id=\"+this.query.exam_id);\r\n                if(answerJson.result && answerJson.result.obj != null){\r\n                    this.answer_form = answerJson.result.obj;\r\n                    this.score_state = answerJson.result.obj.score_state\r\n                    this.answer_form.answers = JSON.parse(this.answer_form.answers);\r\n                    this.answer_form.score_detail = JSON.parse(this.answer_form.score_detail);\r\n                    for(let i=0;i<this.answer_form.answers.length;i++){\r\n                        this.answers[i] = this.answer_form.answers[i].answer;\r\n                        this.answer_scores[i] = this.answer_form.score_detail[i].score;\r\n                        if (this.question_list[i].type==='单选题' || this.question_list[i].type==='判断题' || this.question_list[i].type==='多选题') {\r\n                            if (this.answer_scores[i]!==this.question_list[i].score){\r\n                                this.reference_answers[i]=this.question_list[i].answer;\r\n                            }\r\n                        }else{\r\n                            this.reference_answers[i]=this.question_list[i].answer;\r\n                        }\r\n                    }\r\n                    this.if_answered = true\r\n                }else if(answerJson.error){\r\n                    console.error(answerJson.error);\r\n                }\r\n                if (!this.if_answered){\r\n                    this.maxtime = this.form.duration*60;\r\n                    this.timer = window.setInterval(() => {\r\n                        setTimeout(this.set_countdown(), 0)\r\n                    }, 1000)\r\n                }\r\n            },\r\n            get_question_list(question_str){\r\n                let question_list = question_str.split(\"\\n\");\r\n                return question_list;\r\n            },\r\n            submit_main(){\r\n                let _this = this;\r\n                _this.answer_form.exam_id = _this.query.exam_id;\r\n                for (let i=0;i<_this.answers.length;i++){\r\n                    let obj = {\"exam_question_id\":_this.question_list[i].exam_question_id,\"answer\":_this.answers[i]};\r\n                    _this.answer_form.answers[i] = obj;\r\n                    if (_this.question_list[i].type==='单选题' || _this.question_list[i].type==='判断题') {\r\n                        if (_this.answers[i]===_this.question_list[i].answer){\r\n                            let obj = {\"exam_question_id\":_this.question_list[i].exam_question_id,\"score\":_this.question_list[i].score};\r\n                            _this.answer_form.score_detail[i] = obj;\r\n                            _this.answer_form.objective_score = _this.answer_form.objective_score + _this.question_list[i].score;\r\n                        }else {\r\n                            let obj = {\"exam_question_id\":_this.question_list[i].exam_question_id,\"score\":0};\r\n                            _this.answer_form.score_detail[i] = obj;\r\n                        }\r\n                    }else if (_this.question_list[i].type==='多选题'){\r\n                        let flag = true;\r\n                        let question_answer_list = _this.question_list[i].answer.split(\"|\")\r\n                        if (_this.answers[i].length!==question_answer_list.length){\r\n                            flag = false;\r\n                        }else {\r\n                            for (let j=0;j<question_answer_list.length;j++){\r\n                                if (_this.answers[i].indexOf(question_answer_list[j])===-1){\r\n                                    flag = false;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (flag){\r\n                            let obj = {\"question_id\":_this.question_list[i].question_id,\"score\":_this.question_list[i].score};\r\n                            _this.answer_form.score_detail[i] = obj;\r\n                            _this.answer_form.objective_score = parseFloat(_this.answer_form.objective_score) + parseFloat(_this.question_list[i].score);\r\n                        }else {\r\n                            let obj = {\"question_id\":_this.question_list[i].question_id,\"score\":0};\r\n                            _this.answer_form.score_detail[i] = obj;\r\n                        }\r\n                    }else{\r\n                        let obj = {\"question_id\":_this.question_list[i].question_id,\"score\":0};\r\n                        _this.answer_form.score_detail[i] = obj;\r\n                    }\r\n                }\r\n                _this.answer_form.answers = JSON.stringify(_this.answer_form.answers);\r\n                _this.answer_form.score_detail = JSON.stringify(_this.answer_form.score_detail);\r\n                _this.answer_form.score = parseFloat(_this.answer_form.subjective_score) + parseFloat(_this.answer_form.objective_score);\r\n                let url = _this.url_add;\r\n                this.$post(url, _this.answer_form, function(json, status) {\r\n                    console.log(\"提交结果：\" ,json);\r\n                    if (json.result) {\r\n                        _this.events(\"submit_after\", json, null);\r\n                    } else if (json.error) {\r\n                        _this.$toast(json.error.message, 'danger');\r\n                    }\r\n                });\r\n            },\r\n            set_countdown(){\r\n                if (this.maxtime >= 0) {\r\n                    this.minutes = Math.floor(this.maxtime / 60);\r\n                    this.seconds = Math.floor(this.maxtime % 60);\r\n                    --this.maxtime;\r\n                } else{\r\n                    clearInterval(this.timer);\r\n                    alert(\"时间到，结束!\");\r\n                }\r\n            }\r\n        },\r\n        mounted() {\r\n        },\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    .title_margin{\r\n        width: 1000px;\r\n        margin-top: 20px;\r\n    }\r\n    .answer_submit_button{\r\n        margin-top: 30px;\r\n        padding-left: 70px;\r\n        margin-bottom: 30px;\r\n    }\r\n    .answer_submit_button button{\r\n        width: 100px;\r\n        line-height: 40px;\r\n        border-radius: 5px;\r\n    }\r\n    .answer_btn_submit{\r\n        background-color: blue;\r\n        margin-right: 20px;\r\n        color: white;\r\n    }\r\n    .answer_btn_cancel{\r\n    }\r\n    .countdown{\r\n        width: 1000px;\r\n        margin-top: 20px;\r\n    }\r\n    .countdown span{\r\n        color: red;\r\n    }\r\n    .score_show{\r\n        color: red;\r\n    }\r\n</style>\r\n\r\n"]}]}