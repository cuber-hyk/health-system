{"remainingRequest":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\components\\diy\\list_cart.vue?vue&type=style&index=0&id=0e11f786&scoped=true&lang=css&","dependencies":[{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\components\\diy\\list_cart.vue","mtime":1657768166000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5lbGxpcHNpc18yIHsKICB0ZXh0LW92ZXJmbG93OiAtby1lbGxpcHNpcy1sYXN0bGluZTsKICBvdmVyZmxvdzogaGlkZGVuOwogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogIGRpc3BsYXk6IC13ZWJraXQtYm94OwogIC13ZWJraXQtbGluZS1jbGFtcDogMjsKICBsaW5lLWNsYW1wOiAyOwogIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7Cn0KLmNhcnRfYmxvY2sgewogIG1pbi1oZWlnaHQ6IDU4MHB4OwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47Cn0KLmxpc3RfY2FydCB7CiAgbWFyZ2luOiA1cHggNXB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgYm9yZGVyLXJhZGl1czogMXJlbTsKICBtYXJnaW4tYm90dG9tOiA1cmVtOwp9CgoubGlzdF9jYXJ0IC5pdGVtX2NhcnQgewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzdGFydDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHBhZGRpbmc6IDAuNnJlbTsKfQoKLmxpc3RfY2FydCAuaXRlbV9jYXJ0ICsgLml0ZW1fY2FydCB7CiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWU7Cn0KCi5saXN0X2NhcnQgLmNob29zZV9idG4gewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoKLmxpc3RfY2FydCAuY2hvb3NlX2J0biAuY2lyY2xlIHsKICB3aWR0aDogMXJlbTsKICBoZWlnaHQ6IDFyZW07CiAgYm9yZGVyLXJhZGl1czogNTAlOwp9CgoubGlzdF9jYXJ0IC5jaG9vc2VfYnRuIC5idG5fY2lyY2xlIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgd2lkdGg6IDAuOXJlbTsKICBoZWlnaHQ6IDAuOXJlbTsKICBtYXJnaW4tcmlnaHQ6IDAuNXJlbTsKICBib3JkZXItcmFkaXVzOiA1MCU7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tY29sb3JfZ3JleSk7CiAgY3Vyc29yOiBwb2ludGVyOwp9Ci5saXN0X2NhcnQgLmNob29zZV9idG4gLmJ0bl9jaXJjbGUgLmljb25fd3JhcCB7CiAgY29sb3I6ICNmZmY7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIHRvcDogLTFweDsKfQoubGlzdF9jYXJ0IC5jaG9vc2VfYnRuLmFjdGl2ZSB7CiAgY29sb3I6IHZhcigtLWNvbG9yX3ByaW1hcnkpOwp9CgoubGlzdF9jYXJ0IC5jaG9vc2VfYnRuLmFjdGl2ZSAuYnRuX2NpcmNsZSB7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3JfcHJpbWFyeSk7CiAgYm9yZGVyOiAwOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoKLmxpc3RfY2FydCAuY2FydF9ib2R5IHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICB3aWR0aDogOTAlOwp9Ci5saXN0X2NhcnQgLmNhcnRfYm9keSAuaW1nX2Jsb2NrIHsKICB3aWR0aDogMjAwcHg7CiAgbWluLWhlaWdodDogMTAwcHg7CiAgbWF4LWhlaWdodDogMjAwcHg7Cn0KLmxpc3RfY2FydCAuY2FydF9ib2R5IC5pbWdfYmxvY2sgaW1nIHsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7Cn0KLmxpc3RfY2FydCAucmlnaHRfaW5mbyB7CiAgd2lkdGg6IGNhbGMoMTAwJSAtIDQuNXJlbSk7CiAgcGFkZGluZy1sZWZ0OiAwLjZyZW07CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47Cn0KCi5saXN0X2NhcnQgLnRpdGxlIHsKICBmb250LXNpemU6IDAuNnJlbTsKICB3aWR0aDogODUlOwogIG1hcmdpbi10b3A6IDE1cHg7Cn0KCi5saXN0X2NhcnQgLmJ0bl9kZWwgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDA7CiAgcmlnaHQ6IDA7CiAgd2lkdGg6IDIuMnJlbTsKICBoZWlnaHQ6IDIuMnJlbTsKICBsaW5lLWhlaWdodDogMi4ycmVtOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBjdXJzb3I6IHBvaW50ZXI7CiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tY29sb3JfZGVmYXVsdCk7CiAgYm9yZGVyLXJhZGl1czogNXB4OwogIGZvbnQtc2l6ZTogMThweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvcl9kZWZhdWx0KTsKfQouaWNvbl9kZWwgewogIGNvbG9yOiB3aGl0ZTsKfQoubGlzdF9jYXJ0IC5idG5fZGVsOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvcl9wcmltYXJ5X2IpOwogIGJvcmRlci1jb2xvcjogdmFyKC0tY29sb3JfcHJpbWFyeV9iKTsKfQoubGlzdF9jYXJ0IC5ib3R0b21fcHJpY2UgewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgbWFyZ2luLWJvdHRvbTogMTVweDsKfQoKLmxpc3RfY2FydCAucHJpY2UgewogIGNvbG9yOiB2YXIoLS1jb2xvcl9yZWQpOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGZvbnQtc2l6ZTogMXJlbTsKfQoKLmxpc3RfY2FydCAucHJpY2VfYWdvIHsKICBtYXJnaW4tbGVmdDogMC4yZW07CiAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7CiAgZm9udC1zaXplOiAwLjdyZW07CiAgY29sb3I6ICM5OTk7Cn0KCi5saXN0X2NhcnQgLmhhbmRsZV9udW0gewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgoubGlzdF9jYXJ0IC5oYW5kbGVfbnVtID4gZGl2IHsKICBoZWlnaHQ6IDI1cHg7CiAgd2lkdGg6IDI1cHg7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIG1hcmdpbi1sZWZ0OiAxMHB4Owp9CgoubGlzdF9jYXJ0IC5zdWJ0cmFjdCwKLmFkZCB7CiAgYm9yZGVyOiAxcHggc29saWQgI2VlZTsKICBib3JkZXItcmFkaXVzOiA1MCU7CiAgY29sb3I6ICM5MTkxOTE7CiAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTsKfQoKLmxpc3RfY2FydCAuaGFuZGxlX251bSBzcGFuIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgdG9wOiAtMXB4Owp9CgoubGlzdF9jYXJ0IC5oYW5kbGVfbnVtIC5udW0gewogIHdpZHRoOiAxLjRyZW07Cn0KCi5iYXJfc2V0dGxlIHsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDIuNXJlbTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgcGFkZGluZzogMCAwLjhyZW07CiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWU7Cn0KCi5iYXJfc2V0dGxlIC5jaG9vc2VfYnRuIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgouYmFyX3NldHRsZSAuY2hvb3NlX2J0biAuY2lyY2xlIHsKICB3aWR0aDogMXJlbTsKICBoZWlnaHQ6IDFyZW07CiAgYm9yZGVyLXJhZGl1czogNTAlOwp9CgouYmFyX3NldHRsZSAuY2hvb3NlX2J0biAuYnRuX2NpcmNsZSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAwLjlyZW07CiAgaGVpZ2h0OiAwLjlyZW07CiAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07CiAgYm9yZGVyLXJhZGl1czogNTAlOwogIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWNvbG9yX2dyZXkpOwp9CgouYmFyX3NldHRsZSAuY2hvb3NlX2J0bi5hY3RpdmUgewogIGNvbG9yOiB2YXIoLS1jb2xvcl9wcmltYXJ5KTsKfQoKLmJhcl9zZXR0bGUgLmNob29zZV9idG4uYWN0aXZlIC5idG5fY2lyY2xlIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvcl9wcmltYXJ5KTsKICBib3JkZXI6IDA7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouYmFyX3NldHRsZSAucmlnaHRfc2V0dGxlIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKfQoKLmJhcl9zZXR0bGUgLnN1bV9ibG9jayB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBtYXJnaW4tcmlnaHQ6IDAuNXJlbTsKfQoKLmJhcl9zZXR0bGUgLnN1bSB7CiAgY29sb3I6IHZhcigtLWNvbG9yX3JlZCk7Cn0KCi5iYXJfc2V0dGxlIC5zZXR0bGUgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoKLmJhcl9zZXR0bGUgLmJ0bl9zZXR0bGUgewogIGNvbG9yOiAjZmZmOwogIGJvcmRlci1yYWRpdXM6IDVyZW07CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3JfcmVkKTsKfQoKLmJhcl9zZXR0bGUgLmJ1dHRvbi1ob3ZlciB7CiAgb3BhY2l0eTogMC44Owp9Cg=="},{"version":3,"sources":["list_cart.vue"],"names":[],"mappings":";AAmYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"list_cart.vue","sourceRoot":"src/components/diy","sourcesContent":["<template>\n  <div class=\"cart_block\">\n    <div class=\"list_cart\">\n      <div class=\"item_cart\" v-for=\"(o, i) in list\" :key=\"i\">\n        <!-- 选择按钮 -->\n        <div\n          class=\"choose_btn\"\n          :class=\"{ active: o[vm.selected] }\"\n          @click=\"select_func(o,i)\"\n        >\n          <div class=\"btn_circle\">\n            <span class=\"icon_wrap\">\n              <b-icon v-if=\"o[vm.selected]\" icon=\"check\"></b-icon>\n            </span>\n          </div>\n        </div>\n        <div class=\"cart_body\">\n          <div class=\"img_block\">\n            <img :src=\"$fullUrl(o[vm.img])\" />\n          </div>\n\n          <div class=\"right_info\">\n            <div class=\"title ellipsis_2\">\n              {{ o[vm.title] }}\n            </div>\n            <!-- 删除商品 -->\n             <!-- v-if=\"$check_action('/cart/list', 'del')\" -->\n            <div\n              class=\"btn_del\"\n              @click=\"del_cart(o, i)\"\n            >\n              <b-icon\n                type=\"trash\"\n                class=\"icon_del\"\n                color=\"var(--color_grey)\"\n                icon=\"trash\"\n              ></b-icon>\n            </div>\n            <!-- v-if=\"$check_action('/cart/details', 'set')\" -->\n            <div class=\"bottom_price\">\n              <div class=\"price\">\n                <span>￥{{ o[vm.price] }}</span>\n                <span class=\"price_ago\">￥{{ o[vm.price_ago] }}</span>\n              </div>\n              <div\n                class=\"handle_num\"\n              >\n                <div class=\"subtract\" @click=\"sub_num(o, i)\">\n                  <span>-</span>\n                </div>\n                <div class=\"num\">\n                  {{ o[vm.num] }}\n                </div>\n                <div class=\"add\" @click=\"add_num(o)\">\n                  <span>+</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 全选 -->\n    <div class=\"bar_settle\" v-if=\"$check_action('/order/list', 'add')\">\n      <div\n        class=\"choose_btn\"\n        :class=\"{ active: select_all_flag }\"\n        @click=\"select_all()\"\n      >\n        <div class=\"btn_circle\">\n          <b-icon\n            style=\"color: #fff; font-size: 0.3rem\"\n            v-if=\"select_all_flag\"\n            icon=\"check\"\n          ></b-icon>\n        </div>\n        <span>全选</span>\n      </div>\n      <div class=\"right_settle\">\n        <div class=\"sum_block\">\n          <span>共计：</span>\n          <span class=\"sum\">￥{{ count() }}</span>\n        </div>\n        <div class=\"settle\">\n          <button\n            class=\"btn_settle\"\n            color=\"#fff\"\n            @click=\"settle_all()\"\n            size=\"mini\"\n          >\n            购买\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import  axios from \"axios\"\nexport default {\n  props: {\n    list: {\n      type: Array,\n      default: function () {\n        return [];\n      },\n    },\n    vm: {\n      type: Object,\n      default: function () {\n        return {\n          cart_id: \"cart_id\",\n          title: \"title\",\n          img: \"img\",\n          user_id: \"user_id\",\n          state: \"state\",\n          price: \"price\",\n          price_ago: \"price_ago\",\n          price_count: \"price_count\",\n          num: \"num\",\n          goods_id: \"goods_id\",\n          description: \"description\",\n          selected: \"selected\",\n        };\n      },\n    },\n  },\n  data() {\n    return {\n      sum_price: 0,\n      select_all_flag:false\n    };\n  },\n  computed: {\n  },\n  methods: {\n    count() {\n      var sum_price = 0;\n      this.list.map((o) => {\n        if (o.selected) {\n          sum_price = parseFloat(sum_price) + parseFloat(o.price_count);\n        }\n      });\n      return sum_price;\n    },\n    selectedAll() {\n      return this.list.every((o) => o.selected);\n    },\n    /**\n     * 增加数量\n     * @param {Object} obj 商品对象\n     */\n    add_num(obj) {\n      var { cart_id, num, price, price_count } = obj;\n      num = parseInt(num) + 1;\n      price_count = parseFloat(price_count) + parseFloat(price);\n      this.$post(\n        `~/api/cart/set?cart_id=${cart_id}`,\n        {\n          num,\n          price,\n          price_count,\n        },\n        (res) => {\n          this.list.map((o) => {\n            if (o.cart_id === cart_id) {\n              (o.num = num), (o.price_count = price_count);\n            }\n          });\n        }\n      );\n    },\n    /**\n     * 减少数量\n     * @param { Object } obj 商品对象\n     * @param { Object} i 规定删除项目的位置\n     */\n    sub_num(obj, i) {\n      var { cart_id, num, price, price_count } = obj;\n      num = parseInt(num) - 1;\n      price_count = parseFloat(price_count) - parseFloat(price);\n      if (num === 0) {\n        this.$get(`~/api/cart/del?cart_id=${cart_id}`, {}, (res) => {\n          this.list.splice(i, 1);\n        });\n      } else {\n        this.$post(\n          `~/api/cart/set?cart_id=${cart_id}`,\n          {\n            num,\n            price,\n            price_count,\n          },\n          (res) => {\n            this.list.map((o) => {\n              if (o.cart_id === cart_id) {\n                o.num = num;\n                o.price_count = price_count;\n              }\n            });\n          }\n        );\n      }\n    },\n    /**\n     * 删除购物车\n     * @param { Object } obj 商品对象\n     * @param { Number} i 规定删除项目的位置\n     */\n    del_cart(o, i) {\n      this.$get(`~/api/cart/del?cart_id=${o.cart_id}`, {}, (res) => {\n        this.list.splice(i, 1);\n      });\n    },\n    /**\n     * 选择\n     * @param { Object } o 选择对象\n     */\n    select_func(o,i) {\n      o.selected = !o.selected;\n      this.$set(this.list,i,o);\n      this.select_all_flag =this.selectedAll();\n    },\n    /**\n     * 全选\n     */\n    select_all() {\n      if (this.selectedAll()) {\n        this.list.map((o) => {\n          o.selected = false;\n        });\n        this.select_all_flag = false;\n      } else {\n        this.list.map((o) => {\n          o.selected = true;\n        });\n        this.select_all_flag = true;\n      }\n    },\n    /**\n     * 根据当前时间和随机数生成流水号\n     */\n    order_code() {\n      var orderCode = \"\";\n      for (\n        var i = 0;\n        i < 6;\n        i++ //6位随机数，用以加在时间戳后面。\n      ) {\n        orderCode += Math.floor(Math.random() * 10);\n      }\n      orderCode = new Date().getTime() + orderCode; //时间戳，用来生成订单号。\n      return orderCode;\n    },\n    /**\n     * 异步单个结算\n     * @param { Object } obj 结算对象\n     * @param { Number } index 规定删除项目的位置\n     * @param { Object } order_number 订单编号\n     */\n    async settle_one(obj, index, order_number,address) {\n      // 获取被选中的商品\n      var {\n        title,\n        img,\n        price,\n        price_ago,\n        price_count,\n        num,\n        type,\n        goods_id,\n        description,\n        user_id,\n        cart_id,\n      } = obj;\n      // 请求参数\n      var body = {\n        order_number,\n        title,\n        img,\n        price,\n        price_ago,\n        price_count,\n        num,\n        type,\n        goods_id,\n        description,\n        \"contact_name\":address.obj.name,\n        \"contact_phone\":address.obj.phone,\n        \"contact_address\":address.obj.address,\n        \"postal_code\":address.obj.postcode,\n        user_id,\n      };\n      console.log(body)\n      // 延迟发送添加订单请求\n      await new Promise((resolve, reject) => {\n        this.$post(\"~/api/order/add?\", body, (res) => {\n          if (res.result) {\n            resolve();\n          }\n        });\n      });\n      //删除购物车\n      await new Promise((resolve, reject) => {\n        this.$get(\n          \"~/api/cart/del?\",\n          {\n            cart_id,\n          },\n          (res) => {\n            if (res.result) {\n              this.list.splice(index, 1);\n              resolve();\n            }\n          }\n        );\n      });\n    },\n    /**\n     * 选中的结算\n     */\n    async settle_all() {\n      // 查询库存\n      let flag = false;\n      for (let i=0;i<this.list.length;i++){\n        if (this.list[i].selected) {\n          let goods_json = await this.$get(\"~/api/goods/get_obj?\", {\"goods_id\": this.list[i].goods_id});\n            if (goods_json.result && goods_json.result.obj) {\n              if (this.list[i].num>goods_json.result.obj.inventory){\n                flag = true\n                this.$toast(\"库存不足\");\n                break;\n              }\n            }\n        }\n      }\n      if (flag){\n        return;\n      }\n      //生成订单号\n      var order_number = this.order_code();\n      // 获取联系方式\n      this.$get(\n              \"~/api/address/get_obj?\",\n              {\n                user_id:this.$store.state.user.user_id,\n                default: 1,\n              },\n              (res) => {\n                if (res.result) {\n                  console.log(res.result);\n                  // 选出选中的物品\n                  var list_settle = this.list.map(async (o, i) => {\n                    if (o.selected) {\n                      await this.settle_one(o, i, order_number,res.result);\n                      this.$router.push(\"/order/details?order_number=\" + order_number);\n                    }\n                  });\n                  this.$toast(\"加入订单成功\");\n                } else {\n                  this.$toast(\"地址未添加\");\n                  return;\n                }\n              }\n      );\n    },\n    /**\n     * 判断是否在微信小程序\n     * @return { Boolean }\n     */\n    is_wx_env() {\n      // 判断是否在微信小程序中打开\n      var ua = window.navigator.userAgent.toLowerCase();\n      let that = this;\n      var bool = false;\n      if (ua.match(/MicroMessenger/i) == \"micromessenger\") {\n        //判断是否是微信环境\n        //微信环境下\n      }\n      return bool;\n    },\n  },\n};\n</script>\n\n<style scoped>\n.ellipsis_2 {\n  text-overflow: -o-ellipsis-lastline;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n}\n.cart_block {\n  min-height: 580px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.list_cart {\n  margin: 5px 5px;\n  background-color: #fff;\n  border-radius: 1rem;\n  margin-bottom: 5rem;\n}\n\n.list_cart .item_cart {\n  display: flex;\n  justify-content: start;\n  align-items: center;\n  padding: 0.6rem;\n}\n\n.list_cart .item_cart + .item_cart {\n  border-top: 1px solid #eee;\n}\n\n.list_cart .choose_btn {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.list_cart .choose_btn .circle {\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n}\n\n.list_cart .choose_btn .btn_circle {\n  display: inline-block;\n  width: 0.9rem;\n  height: 0.9rem;\n  margin-right: 0.5rem;\n  border-radius: 50%;\n  border: 1px solid var(--color_grey);\n  cursor: pointer;\n}\n.list_cart .choose_btn .btn_circle .icon_wrap {\n  color: #fff;\n  position: relative;\n  top: -1px;\n}\n.list_cart .choose_btn.active {\n  color: var(--color_primary);\n}\n\n.list_cart .choose_btn.active .btn_circle {\n  background-color: var(--color_primary);\n  border: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.list_cart .cart_body {\n  display: flex;\n  justify-content: space-between;\n  align-items: stretch;\n  width: 90%;\n}\n.list_cart .cart_body .img_block {\n  width: 200px;\n  min-height: 100px;\n  max-height: 200px;\n}\n.list_cart .cart_body .img_block img {\n  width: 100%;\n  height: 100%;\n}\n.list_cart .right_info {\n  width: calc(100% - 4.5rem);\n  padding-left: 0.6rem;\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n  flex-direction: column;\n}\n\n.list_cart .title {\n  font-size: 0.6rem;\n  width: 85%;\n  margin-top: 15px;\n}\n\n.list_cart .btn_del {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 2.2rem;\n  height: 2.2rem;\n  line-height: 2.2rem;\n  text-align: center;\n  cursor: pointer;\n  border: 1px solid var(--color_default);\n  border-radius: 5px;\n  font-size: 18px;\n  background: var(--color_default);\n}\n.icon_del {\n  color: white;\n}\n.list_cart .btn_del:hover {\n  background: var(--color_primary_b);\n  border-color: var(--color_primary_b);\n}\n.list_cart .bottom_price {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 15px;\n}\n\n.list_cart .price {\n  color: var(--color_red);\n  font-weight: bold;\n  font-size: 1rem;\n}\n\n.list_cart .price_ago {\n  margin-left: 0.2em;\n  text-decoration: line-through;\n  font-size: 0.7rem;\n  color: #999;\n}\n\n.list_cart .handle_num {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n}\n\n.list_cart .handle_num > div {\n  height: 25px;\n  width: 25px;\n  text-align: center;\n  margin-left: 10px;\n}\n\n.list_cart .subtract,\n.add {\n  border: 1px solid #eee;\n  border-radius: 50%;\n  color: #919191;\n  background-color: #eee;\n}\n\n.list_cart .handle_num span {\n  position: relative;\n  top: -1px;\n}\n\n.list_cart .handle_num .num {\n  width: 1.4rem;\n}\n\n.bar_settle {\n  width: 100%;\n  height: 2.5rem;\n  background-color: #fff;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 0.8rem;\n  border-top: 1px solid #eee;\n}\n\n.bar_settle .choose_btn {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n\n.bar_settle .choose_btn .circle {\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n}\n\n.bar_settle .choose_btn .btn_circle {\n  display: inline-block;\n  width: 0.9rem;\n  height: 0.9rem;\n  margin-right: 0.5rem;\n  border-radius: 50%;\n  border: 1px solid var(--color_grey);\n}\n\n.bar_settle .choose_btn.active {\n  color: var(--color_primary);\n}\n\n.bar_settle .choose_btn.active .btn_circle {\n  background-color: var(--color_primary);\n  border: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.bar_settle .right_settle {\n  display: flex;\n  justify-content: space-between;\n}\n\n.bar_settle .sum_block {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-right: 0.5rem;\n}\n\n.bar_settle .sum {\n  color: var(--color_red);\n}\n\n.bar_settle .settle {\n  display: flex;\n  align-items: center;\n}\n\n.bar_settle .btn_settle {\n  color: #fff;\n  border-radius: 5rem;\n  background-color: var(--color_red);\n}\n\n.bar_settle .button-hover {\n  opacity: 0.8;\n}\n</style>\n"]}]}