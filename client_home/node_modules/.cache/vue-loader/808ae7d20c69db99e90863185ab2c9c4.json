{"remainingRequest":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\views\\pay\\details.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\src\\views\\pay\\details.vue","mtime":1657768166000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\weixinback\\wxid_5488mcc1cgih21\\WeChat Files\\wxid_5488mcc1cgih21\\FileStorage\\File\\2022-12\\client_home\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtaXhpbiBmcm9tICJAL21peGlucy9wYWdlLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG1peGluczogW21peGluXSwKCiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHF1ZXJ5OiB7CiAgICAgICAgc3VtX3ByaWNlOiAiIiwKICAgICAgICBvcmRlcl9udW1iZXI6IiIsCiAgICAgICAgc2VsZWN0ZWQ6ICIiCiAgICAgIH0sCiAgICAgIHBheV9vYmo6ewogICAgICAgIHBheUFjdGl2ZU5hbWU6IuW+ruS/oSIsCiAgICAgICAgYWNjb3VudDoiIiwKICAgICAgICBwYXNzd29yZDoiIiwKICAgICAgICBpZDoiIgogICAgICB9CiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHVwZGF0ZV9nb29kc19pbnZlbnRvcnkobyl7CiAgICAgIGF3YWl0IHRoaXMuJGdldCgifi9hcGkvZ29vZHMvZ2V0X29iaj8iLCB7Imdvb2RzX2lkIjpvLmdvb2RzX2lkfSwgKGpzb24pID0+IHsKICAgICAgICBpZiAoanNvbi5yZXN1bHQgJiYganNvbi5yZXN1bHQub2JqKSB7CiAgICAgICAgICBsZXQgaW52ZW50b3J5ID0geyJpbnZlbnRvcnkiOmpzb24ucmVzdWx0Lm9iai5pbnZlbnRvcnktby5udW19OwogICAgICAgICAgdGhpcy4kcG9zdCgnfi9hcGkvZ29vZHMvc2V0P2dvb2RzX2lkPScrby5nb29kc19pZCwgaW52ZW50b3J5LCAocmVzKSA9PiB7CiAgICAgICAgICAgIGlmKHJlcy5yZXN1bHQgJiYganNvbi5yZXN1bHQub2JqLnNvdXJjZV90YWJsZSAmJiBqc29uLnJlc3VsdC5vYmouc291cmNlX2ZpZWxkICYmIGpzb24ucmVzdWx0Lm9iai5zb3VyY2VfaWQpewogICAgICAgICAgICAgIGxldCBpbnZlbnRvcnlfc3ViID0geyJjYXJ0X2ludmVudG9yeSI6aW52ZW50b3J5LmludmVudG9yeX07CiAgICAgICAgICAgICAgdGhpcy4kcG9zdCgnfi9hcGkvJytqc29uLnJlc3VsdC5vYmouc291cmNlX3RhYmxlKycvc2V0PycranNvbi5yZXN1bHQub2JqLnNvdXJjZV9maWVsZCsnPScranNvbi5yZXN1bHQub2JqLnNvdXJjZV9pZCwgaW52ZW50b3J5X3N1YiwgKHJlc19zdWIpID0+IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc19zdWIpCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgcGF5KCkgewogICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICB0aGlzLiRwb3N0KCJ+L2FwaS9vcmRlci9zZXQ/b3JkZXJfbnVtYmVyPSIrX3RoaXMucXVlcnkub3JkZXJfbnVtYmVyLHsKICAgICAgICBzdGF0ZToi5bey5LuY5qy+IgogICAgICB9LChyZXMpPT57CiAgICAgICAgaWYocmVzLnJlc3VsdCl7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMucmVzdWx0KTsKICAgICAgICAgIHRoaXMuJGdldCgifi9hcGkvb3JkZXIvZ2V0X2xpc3Q/IiwgeyJvcmRlcl9udW1iZXIiOl90aGlzLnF1ZXJ5Lm9yZGVyX251bWJlcn0sIChqc29uKSA9PiB7CiAgICAgICAgICAgIGlmIChqc29uLnJlc3VsdCAmJiBqc29uLnJlc3VsdC5saXN0KSB7CiAgICAgICAgICAgICAgLy/kv67mlLnmlbDph48KICAgICAgICAgICAgICBmb3IobGV0IGk9MDtpPGpzb24ucmVzdWx0Lmxpc3QubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVfZ29vZHNfaW52ZW50b3J5KGpzb24ucmVzdWx0Lmxpc3RbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSkKCiAgICAgICAgICB0aGlzLiR0b2FzdCgi5pSv5LuY5oiQ5YqfIikKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvb3JkZXIvbGlzdD9zdGF0ZT3lt7Lku5jmrL4iKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogIH0sCn07Cg=="},{"version":3,"sources":["details.vue"],"names":[],"mappings":";AA8FA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"details.vue","sourceRoot":"src/views/pay","sourcesContent":["<template>\n  <div class=\"page_pay\" id=\"page_pay\">\n    <div class=\"warp\">\n      <div class=\"container\">\n        <div class=\"row\">\n          <div class=\"col-12 col-md-6\">\n            <b-card no-body style=\"\">\n              <template #header>\n                <h4 class=\"text-center\">总支付：￥{{ query.sum_price }}</h4>\n              </template>\n\n              <b-card-body>\n                <b-tabs content-class=\"mt-3\">\n                  <b-tab title=\"微信\" :active=\"true\">\n                    <div class=\"row\">\n                      <div class=\"col\">\n                        <div style=\"width: 60%;margin: 0 auto\"><img src=\"../../../public/img/wx.png\"></div>\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\n                          >支付</b-button\n                          >\n                        </b-card-footer>\n                      </div>\n                    </div>\n                  </b-tab>\n                  <b-tab title=\"支付宝\" :active=\"false\">\n                    <div class=\"row\">\n                      <div class=\"col\">\n                        <div style=\"width: 60%;margin: 0 auto\"><img src=\"../../../public/img/aplipay.png\"></div>\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\n                          >支付</b-button\n                          >\n                        </b-card-footer>\n                      </div>\n                    </div>\n                  </b-tab>\n                  <b-tab title=\"网银\" :active=\"false\">\n                    <div class=\"row\">\n                      <div class=\"col\">\n                        <div style=\"width: 80%;margin: 0 auto;margin-top: 30px;\">\n                          <div style=\"width: 80%;margin: 0 auto;\">\n                            <div style=\"line-height: 40px\">请输入网银账号：</div>\n                          </div>\n                          <div style=\"width: 80%;margin: 0 auto;\">\n                            <input v-model=\"pay_obj.account\" placeholder=\"请输入网银账号\" />\n                          </div>\n                        </div>\n                        <div style=\"width: 80%;margin: 0 auto;margin-top: 20px;\">\n                          <div style=\"width: 80%;margin: 0 auto;\">\n                            <div style=\"line-height: 40px\">请输入支付密码，6位数字：</div>\n                          </div>\n                          <div style=\"width: 80%;margin: 0 auto;\">\n                            <input placeholder=\"请输入密码\" type=\"password\" v-model=\"pay_obj.password\" maxlength=\"6\" />\n                          </div>\n                        </div>\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\n                          >支付</b-button\n                          >\n                        </b-card-footer>\n                      </div>\n                    </div>\n                  </b-tab>\n                </b-tabs>\n                <!--<b-form-group label=\"支付方式\" v-slot=\"{ ariaDescribedby }\">-->\n                  <!--<b-form-radio-->\n                    <!--v-model=\"selected\"-->\n                    <!--:aria-describedby=\"ariaDescribedby\"-->\n                    <!--name=\"some-radios\"-->\n                    <!--value=\"A\"-->\n                  <!--&gt;-->\n                    <!--支付宝-->\n                  <!--</b-form-radio>-->\n                  <!--<b-form-radio-->\n                    <!--v-model=\"selected\"-->\n                    <!--:aria-describedby=\"ariaDescribedby\"-->\n                    <!--name=\"some-radios\"-->\n                    <!--value=\"B\"-->\n                  <!--&gt;-->\n                    <!--微信-->\n                  <!--</b-form-radio>-->\n                <!--</b-form-group>-->\n              </b-card-body>\n\n            </b-card>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport mixin from \"@/mixins/page.js\";\nexport default {\n  mixins: [mixin],\n\n  components: {},\n  data() {\n    return {\n      query: {\n        sum_price: \"\",\n        order_number:\"\",\n        selected: \"\"\n      },\n      pay_obj:{\n        payActiveName:\"微信\",\n        account:\"\",\n        password:\"\",\n        id:\"\"\n      }\n    };\n  },\n\n  methods: {\n    async update_goods_inventory(o){\n      await this.$get(\"~/api/goods/get_obj?\", {\"goods_id\":o.goods_id}, (json) => {\n        if (json.result && json.result.obj) {\n          let inventory = {\"inventory\":json.result.obj.inventory-o.num};\n          this.$post('~/api/goods/set?goods_id='+o.goods_id, inventory, (res) => {\n            if(res.result && json.result.obj.source_table && json.result.obj.source_field && json.result.obj.source_id){\n              let inventory_sub = {\"cart_inventory\":inventory.inventory};\n              this.$post('~/api/'+json.result.obj.source_table+'/set?'+json.result.obj.source_field+'='+json.result.obj.source_id, inventory_sub, (res_sub) => {\n                console.log(res_sub)\n              })\n            }\n          })\n        }\n      })\n    },\n    pay() {\n      let _this = this;\n      this.$post(\"~/api/order/set?order_number=\"+_this.query.order_number,{\n        state:\"已付款\"\n      },(res)=>{\n        if(res.result){\n          console.log(res.result);\n          this.$get(\"~/api/order/get_list?\", {\"order_number\":_this.query.order_number}, (json) => {\n            if (json.result && json.result.list) {\n              //修改数量\n              for(let i=0;i<json.result.list.length;i++){\n                _this.update_goods_inventory(json.result.list[i]);\n              }\n            }\n          })\n\n          this.$toast(\"支付成功\")\n          this.$router.push(\"/order/list?state=已付款\")\n        }\n      })\n    },\n  },\n  mounted() {\n  },\n};\n</script>\n\n<style scoped>\n.container {\n  min-height: 800px;\n}\n</style>\n"]}]}