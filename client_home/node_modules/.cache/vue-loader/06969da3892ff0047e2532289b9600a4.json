{"remainingRequest":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\src\\views\\pay\\details.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\src\\views\\pay\\details.vue","mtime":1675233590000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\bishe\\Desktop\\springboot专利管理系统[编号：CS781820_20220828094342] (4)\\client_home\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgbWl4aW4gZnJvbSAiQC9taXhpbnMvcGFnZS5qcyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG1peGluczogW21peGluXSwNCg0KICBjb21wb25lbnRzOiB7fSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcXVlcnk6IHsNCiAgICAgICAgc3VtX3ByaWNlOiAiIiwNCiAgICAgICAgb3JkZXJfbnVtYmVyOiIiLA0KICAgICAgICBzZWxlY3RlZDogIiINCiAgICAgIH0sDQogICAgICBwYXlfb2JqOnsNCiAgICAgICAgcGF5QWN0aXZlTmFtZToi5b6u5L+hIiwNCiAgICAgICAgYWNjb3VudDoiIiwNCiAgICAgICAgcGFzc3dvcmQ6IiIsDQogICAgICAgIGlkOiIiDQogICAgICB9DQogICAgfTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgdXBkYXRlX2dvb2RzX2ludmVudG9yeShvKXsNCiAgICAgIGF3YWl0IHRoaXMuJGdldCgifi9hcGkvZ29vZHMvZ2V0X29iaj8iLCB7Imdvb2RzX2lkIjpvLmdvb2RzX2lkfSwgKGpzb24pID0+IHsNCiAgICAgICAgaWYgKGpzb24ucmVzdWx0ICYmIGpzb24ucmVzdWx0Lm9iaikgew0KICAgICAgICAgIGxldCBpbnZlbnRvcnkgPSB7ImludmVudG9yeSI6anNvbi5yZXN1bHQub2JqLmludmVudG9yeS1vLm51bX07DQogICAgICAgICAgdGhpcy4kcG9zdCgnfi9hcGkvZ29vZHMvc2V0P2dvb2RzX2lkPScrby5nb29kc19pZCwgaW52ZW50b3J5LCAocmVzKSA9PiB7DQogICAgICAgICAgICBpZihyZXMucmVzdWx0ICYmIGpzb24ucmVzdWx0Lm9iai5zb3VyY2VfdGFibGUgJiYganNvbi5yZXN1bHQub2JqLnNvdXJjZV9maWVsZCAmJiBqc29uLnJlc3VsdC5vYmouc291cmNlX2lkKXsNCiAgICAgICAgICAgICAgbGV0IGludmVudG9yeV9zdWIgPSB7ImNhcnRfaW52ZW50b3J5IjppbnZlbnRvcnkuaW52ZW50b3J5fTsNCiAgICAgICAgICAgICAgdGhpcy4kcG9zdCgnfi9hcGkvJytqc29uLnJlc3VsdC5vYmouc291cmNlX3RhYmxlKycvc2V0PycranNvbi5yZXN1bHQub2JqLnNvdXJjZV9maWVsZCsnPScranNvbi5yZXN1bHQub2JqLnNvdXJjZV9pZCwgaW52ZW50b3J5X3N1YiwgKHJlc19zdWIpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNfc3ViKQ0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBwYXkoKSB7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgdGhpcy4kcG9zdCgifi9hcGkvb3JkZXIvc2V0P29yZGVyX251bWJlcj0iK190aGlzLnF1ZXJ5Lm9yZGVyX251bWJlcix7DQogICAgICAgIHN0YXRlOiLlt7Lku5jmrL4iDQogICAgICB9LChyZXMpPT57DQogICAgICAgIGlmKHJlcy5yZXN1bHQpew0KICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5yZXN1bHQpOw0KICAgICAgICAgIHRoaXMuJGdldCgifi9hcGkvb3JkZXIvZ2V0X2xpc3Q/IiwgeyJvcmRlcl9udW1iZXIiOl90aGlzLnF1ZXJ5Lm9yZGVyX251bWJlcn0sIChqc29uKSA9PiB7DQogICAgICAgICAgICBpZiAoanNvbi5yZXN1bHQgJiYganNvbi5yZXN1bHQubGlzdCkgew0KICAgICAgICAgICAgICAvL+S/ruaUueaVsOmHjw0KICAgICAgICAgICAgICBmb3IobGV0IGk9MDtpPGpzb24ucmVzdWx0Lmxpc3QubGVuZ3RoO2krKyl7DQogICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlX2dvb2RzX2ludmVudG9yeShqc29uLnJlc3VsdC5saXN0W2ldKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQoNCiAgICAgICAgICB0aGlzLiR0b2FzdCgi5pSv5LuY5oiQ5YqfIikNCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL29yZGVyL2xpc3Q/c3RhdGU95bey5LuY5qy+IikNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkgew0KICB9LA0KfTsNCg=="},{"version":3,"sources":["details.vue"],"names":[],"mappings":";AA8FA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"details.vue","sourceRoot":"src/views/pay","sourcesContent":["<template>\r\n  <div class=\"page_pay\" id=\"page_pay\">\r\n    <div class=\"warp\">\r\n      <div class=\"container\">\r\n        <div class=\"row\">\r\n          <div class=\"col-12 col-md-6\">\r\n            <b-card no-body style=\"\">\r\n              <template #header>\r\n                <h4 class=\"text-center\">总支付：￥{{ query.sum_price }}</h4>\r\n              </template>\r\n\r\n              <b-card-body>\r\n                <b-tabs content-class=\"mt-3\">\r\n                  <b-tab title=\"微信\" :active=\"true\">\r\n                    <div class=\"row\">\r\n                      <div class=\"col\">\r\n                        <div style=\"width: 60%;margin: 0 auto\"><img src=\"../../../public/img/wx.png\"></div>\r\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\r\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\r\n                          >支付</b-button\r\n                          >\r\n                        </b-card-footer>\r\n                      </div>\r\n                    </div>\r\n                  </b-tab>\r\n                  <b-tab title=\"支付宝\" :active=\"false\">\r\n                    <div class=\"row\">\r\n                      <div class=\"col\">\r\n                        <div style=\"width: 60%;margin: 0 auto\"><img src=\"../../../public/img/aplipay.png\"></div>\r\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\r\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\r\n                          >支付</b-button\r\n                          >\r\n                        </b-card-footer>\r\n                      </div>\r\n                    </div>\r\n                  </b-tab>\r\n                  <b-tab title=\"网银\" :active=\"false\">\r\n                    <div class=\"row\">\r\n                      <div class=\"col\">\r\n                        <div style=\"width: 80%;margin: 0 auto;margin-top: 30px;\">\r\n                          <div style=\"width: 80%;margin: 0 auto;\">\r\n                            <div style=\"line-height: 40px\">请输入网银账号：</div>\r\n                          </div>\r\n                          <div style=\"width: 80%;margin: 0 auto;\">\r\n                            <input v-model=\"pay_obj.account\" placeholder=\"请输入网银账号\" />\r\n                          </div>\r\n                        </div>\r\n                        <div style=\"width: 80%;margin: 0 auto;margin-top: 20px;\">\r\n                          <div style=\"width: 80%;margin: 0 auto;\">\r\n                            <div style=\"line-height: 40px\">请输入支付密码，6位数字：</div>\r\n                          </div>\r\n                          <div style=\"width: 80%;margin: 0 auto;\">\r\n                            <input placeholder=\"请输入密码\" type=\"password\" v-model=\"pay_obj.password\" maxlength=\"6\" />\r\n                          </div>\r\n                        </div>\r\n                        <b-card-footer style=\"margin-top: 10px\" class=\"text-center\">\r\n                          <b-button variant=\"outline-primary\" @click=\"pay\" block\r\n                          >支付</b-button\r\n                          >\r\n                        </b-card-footer>\r\n                      </div>\r\n                    </div>\r\n                  </b-tab>\r\n                </b-tabs>\r\n                <!--<b-form-group label=\"支付方式\" v-slot=\"{ ariaDescribedby }\">-->\r\n                  <!--<b-form-radio-->\r\n                    <!--v-model=\"selected\"-->\r\n                    <!--:aria-describedby=\"ariaDescribedby\"-->\r\n                    <!--name=\"some-radios\"-->\r\n                    <!--value=\"A\"-->\r\n                  <!--&gt;-->\r\n                    <!--支付宝-->\r\n                  <!--</b-form-radio>-->\r\n                  <!--<b-form-radio-->\r\n                    <!--v-model=\"selected\"-->\r\n                    <!--:aria-describedby=\"ariaDescribedby\"-->\r\n                    <!--name=\"some-radios\"-->\r\n                    <!--value=\"B\"-->\r\n                  <!--&gt;-->\r\n                    <!--微信-->\r\n                  <!--</b-form-radio>-->\r\n                <!--</b-form-group>-->\r\n              </b-card-body>\r\n\r\n            </b-card>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport mixin from \"@/mixins/page.js\";\r\nexport default {\r\n  mixins: [mixin],\r\n\r\n  components: {},\r\n  data() {\r\n    return {\r\n      query: {\r\n        sum_price: \"\",\r\n        order_number:\"\",\r\n        selected: \"\"\r\n      },\r\n      pay_obj:{\r\n        payActiveName:\"微信\",\r\n        account:\"\",\r\n        password:\"\",\r\n        id:\"\"\r\n      }\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    async update_goods_inventory(o){\r\n      await this.$get(\"~/api/goods/get_obj?\", {\"goods_id\":o.goods_id}, (json) => {\r\n        if (json.result && json.result.obj) {\r\n          let inventory = {\"inventory\":json.result.obj.inventory-o.num};\r\n          this.$post('~/api/goods/set?goods_id='+o.goods_id, inventory, (res) => {\r\n            if(res.result && json.result.obj.source_table && json.result.obj.source_field && json.result.obj.source_id){\r\n              let inventory_sub = {\"cart_inventory\":inventory.inventory};\r\n              this.$post('~/api/'+json.result.obj.source_table+'/set?'+json.result.obj.source_field+'='+json.result.obj.source_id, inventory_sub, (res_sub) => {\r\n                console.log(res_sub)\r\n              })\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    pay() {\r\n      let _this = this;\r\n      this.$post(\"~/api/order/set?order_number=\"+_this.query.order_number,{\r\n        state:\"已付款\"\r\n      },(res)=>{\r\n        if(res.result){\r\n          console.log(res.result);\r\n          this.$get(\"~/api/order/get_list?\", {\"order_number\":_this.query.order_number}, (json) => {\r\n            if (json.result && json.result.list) {\r\n              //修改数量\r\n              for(let i=0;i<json.result.list.length;i++){\r\n                _this.update_goods_inventory(json.result.list[i]);\r\n              }\r\n            }\r\n          })\r\n\r\n          this.$toast(\"支付成功\")\r\n          this.$router.push(\"/order/list?state=已付款\")\r\n        }\r\n      })\r\n    },\r\n  },\r\n  mounted() {\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  min-height: 800px;\r\n}\r\n</style>\r\n"]}]}